section_li = [{'Index': 1, 'Start': 4587.916666666667, 'End': 7857.85},
{'Index': 2, 'Start': 7857.85, 'End': 14631.283333333335},
{'Index': 3, 'Start': 14631.283333333335, 'End': 25508.81666666667, 'CloseWindow': True},
{'Index': 4, 'Start': 26443.083333333336, 'End': 31598.233333333337},
{'Index': 5, 'Start': 31598.233333333337, 'End': 34718.01666666667},
{'Index': 6, 'Start': 34718.01666666667, 'End': 40106.73333333334, 'CloseWindow': True},
{'Index': 7, 'Start': 41591.55, 'End': 48248.200000000004},
{'Index': 8, 'Start': 48248.200000000004, 'End': 59092.36666666667},
{'Index': 9, 'Start': 59092.36666666667, 'End': 64147.41666666667},
{'Index': 10, 'Start': 64147.41666666667, 'End': 65548.81666666667},
{'Index': 11, 'Start': 65548.81666666667, 'End': 70019.95000000001},
{'Index': 12, 'Start': 70019.95000000001, 'End': 72839.43333333333},
{'Index': 13, 'Start': 72839.43333333333, 'End': 77610.86666666667},
{'Index': 14, 'Start': 77610.86666666667, 'End': 83750.33333333334},
{'Index': 15, 'Start': 83750.33333333334, 'End': 86903.48333333334, 'CloseWindow': True},
{'Index': 16, 'Start': 88154.73333333334, 'End': 96696.6},
{'Index': 17, 'Start': 96696.6, 'End': 101301.20000000001},
{'Index': 18, 'Start': 101301.20000000001, 'End': 109542.76666666666},
{'Index': 19, 'Start': 109542.76666666666, 'End': 115682.23333333334},
{'Index': 20, 'Start': 115682.23333333334, 'End': 121221.1},
{'Index': 21, 'Start': 121221.1, 'End': 129646.18333333333},
{'Index': 22, 'Start': 129646.18333333333, 'End': 138204.73333333334},
{'Index': 23, 'Start': 138204.73333333334, 'End': 140106.63333333336},
{'Index': 24, 'Start': 140106.63333333336, 'End': 145311.83333333334},
{'Index': 25, 'Start': 145311.83333333334, 'End': 149549.40000000002, 'CloseWindow': True},
{'Index': 26, 'Start': 150984.1666666667, 'End': 160426.93333333335},
{'Index': 27, 'Start': 160426.93333333335, 'End': 167901.06666666668},
{'Index': 28, 'Start': 167901.06666666668, 'End': 171171.00000000003},
{'Index': 29, 'Start': 171171.00000000003, 'End': 178411.56666666668},
{'Index': 30, 'Start': 178411.56666666668, 'End': 185501.98333333334},
{'Index': 31, 'Start': 185501.98333333334, 'End': 191958.43333333335},
{'Index': 32, 'Start': 191958.43333333335, 'End': 194878.01666666666, 'CloseWindow': True},
{'Index': 33, 'Start': 196329.4666666667, 'End': 202852.65000000002},
{'Index': 34, 'Start': 202852.65000000002, 'End': 208775.23333333334},
{'Index': 35, 'Start': 208775.23333333334, 'End': 221454.56666666665},
{'Index': 36, 'Start': 221454.56666666665, 'End': 225592.03333333335},
{'Index': 37, 'Start': 225592.03333333335, 'End': 230713.81666666668, 'CloseWindow': True},
{'Index': 38, 'Start': 230880.65, 'End': 230897.33333333334, 'CloseWindow': True},
{'Index': 39, 'Start': 230997.43333333332, 'End': 231014.11666666667, 'CloseWindow': True},
{'Index': 40, 'Start': 231080.85, 'End': 231114.21666666667, 'CloseWindow': True},
{'Index': 41, 'Start': 231164.2666666667, 'End': 231197.63333333336, 'CloseWindow': True},
{'Index': 42, 'Start': 231214.31666666668, 'End': 231231.00000000003, 'CloseWindow': True},
{'Index': 43, 'Start': 231264.3666666667, 'End': 234217.31666666668},
{'Index': 44, 'Start': 234217.31666666668, 'End': 236669.76666666666},
{'Index': 45, 'Start': 236669.76666666666, 'End': 242508.93333333335},
{'Index': 46, 'Start': 242508.93333333335, 'End': 250500.25000000003},
{'Index': 47, 'Start': 250500.25000000003, 'End': 258558.30000000002, 'CloseWindow': True},
{'Index': 48, 'Start': 260009.75, 'End': 264130.5333333333},
{'Index': 49, 'Start': 264130.5333333333, 'End': 272789.18333333335, 'CloseWindow': True},
{'Index': 50, 'Start': 272989.38333333336, 'End': 274340.73333333334},
{'Index': 51, 'Start': 274340.73333333334, 'End': 279312.36666666664},
{'Index': 52, 'Start': 279312.36666666664, 'End': 283750.13333333336},
{'Index': 53, 'Start': 283750.13333333336, 'End': 289739.45},
{'Index': 54, 'Start': 289739.45, 'End': 295895.6},
{'Index': 55, 'Start': 295895.6, 'End': 298765.1333333333},
{'Index': 56, 'Start': 298765.1333333333, 'End': 304320.68333333335},
{'Index': 57, 'Start': 304320.68333333335, 'End': 306339.3666666667},
{'Index': 58, 'Start': 306339.3666666667, 'End': 309292.3166666667},
{'Index': 59, 'Start': 309292.3166666667, 'End': 315548.56666666665},
{'Index': 60, 'Start': 315548.56666666665, 'End': 322472.15},
{'Index': 61, 'Start': 322472.15, 'End': 327810.8166666667},
{'Index': 62, 'Start': 327810.8166666667, 'End': 336252.5833333334},
{'Index': 63, 'Start': 336252.5833333334, 'End': 339856.18333333335},
{'Index': 64, 'Start': 339856.18333333335, 'End': 342925.9166666667, 'CloseWindow': True},
{'Index': 65, 'Start': 344344.0, 'End': 346029.01666666666},
{'Index': 66, 'Start': 346029.01666666666, 'End': 349165.48333333334},
{'Index': 67, 'Start': 349165.48333333334, 'End': 352001.65, 'CloseWindow': True},
{'Index': 68, 'Start': 353436.4166666667, 'End': 358257.9},
{'Index': 69, 'Start': 358257.9, 'End': 365481.7833333333},
{'Index': 70, 'Start': 365481.7833333333, 'End': 370436.73333333334},
{'Index': 71, 'Start': 370436.73333333334, 'End': 373406.36666666664, 'CloseWindow': True}]

from videotest import get_tstamp

def jitter_cleaner(img_sections) -> list:
    remove_li = []
    for im in img_sections:
        if im['End'] - im['Start'] < 1000.0:
            remove_li.append(im)
        im['Start'] = get_tstamp(im['Start'])
        im['End'] = get_tstamp(im['End'])

    tmp = []
    remove_subli = []
    for r in remove_li:
        img_sections.remove(r)
        if len(remove_subli) == 0 or remove_subli[-1]['Index'] + 1 == r['Index']:
            remove_subli.append(r)
        else:
            if len(remove_subli) >= 2:
                tmp.append(remove_subli)
            remove_subli = [r]
    if len(remove_subli) >= 2:
        tmp.append(remove_subli)
        remove_subli = []

    alert = []
    count = 0
    for t in tmp:
        start = t[0]['Start']
        end = t[-1]['End']
        alert.append({'Index':count, 'Start':start, 'End':end, 'Jitter':True})

    for i in range(len(img_sections)):
        img = img_sections[i]
        img['Index'] = i+1

    return img_sections, alert
